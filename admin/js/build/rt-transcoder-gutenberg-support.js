!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){!function(){e.exports=this.wp.hooks}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.compose}()},function(e,t){!function(){e.exports=this.wp.blockEditor}()},function(e,t){!function(){e.exports=this.wp.apiFetch}()},function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(4),i=r(3),a=r(2),c=r(1),d=r(5),u=r(6),s=r.n(u),l=["amp/amp-story-page","core/video"],p=window.rtTranscoderBlockEditorSupport,b=void 0!==p.rt_default_video_quality?p.rt_default_video_quality:"high";Object(a.addFilter)("blocks.registerBlockType","transcoder/ampStoryBackgroundVideoQuality",(function(e,t){return l.includes(t)?(void 0!==e.attributes&&(e.attributes=Object.assign(e.attributes,{rtBackgroundVideoQuality:{type:"string",default:b}})),e):e}),9);var f=Object(o.createHigherOrderComponent)((function(e){return function(t){if(!l.includes(t.name))return Object(n.createElement)(e,t);var r=t.attributes,o="amp/amp-story-page"===t.name,a="core/video"===t.name,u=(o?r.mediaId:r.id,r.mediaType?r.mediaType:""),s=r.rtBackgroundVideoQuality;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(e,t),(a||o&&"video"===u)&&Object(n.createElement)(d.InspectorControls,null,Object(n.createElement)(i.PanelBody,{title:Object(c.__)("Transcoder Settings","transcoder"),initialOpen:!0},Object(n.createElement)(i.SelectControl,{label:Object(c.__)("Background Video Quality","transcoder"),value:s,options:[{value:"low",label:Object(c.__)("Low","transcoder")},{value:"medium",label:Object(c.__)("Medium","transcoder")},{value:"high",label:Object(c.__)("High","transcoder")}],onChange:function(e){t.setAttributes({rtBackgroundVideoQuality:e})}}))))}}),"withTranscoderSettings");Object(a.addFilter)("editor.BlockEdit","rt-transcoder-amp/with-transcoder-settings",f,12);Object(a.addFilter)("editor.BlockEdit","rt-transcoder-amp/set-media-attributes",(function(e){return function(t){if(!l.includes(t.name))return Object(n.createElement)(e,t);var r=t.attributes,o="amp/amp-story-page"===t.name,i="core/video"===t.name,a=o?r.mediaId:r.id;r.mediaType&&r.mediaType;if(void 0!==a)if(void 0===r.poster)o&&void 0!==r.mediaType&&"video"===r.mediaType&&!r.mediaUrl.endsWith("mp4")?t.setAttributes({poster:p.amp_story_fallback_poster}):i&&void 0!==r.src&&0!==r.src.indexOf("blob:")&&!r.src.endsWith("mp4")&&t.setAttributes({poster:p.amp_video_fallback_poster});else{s()({path:"".concat("/transcoder/v1/amp-media","/").concat(a)}).then((function(e){var n=t.attributes.rtBackgroundVideoQuality?t.attributes.rtBackgroundVideoQuality:b;!1!==e&&null!==e&&e.poster.length&&e[n].transcodedMedia.length&&(o&&void 0!==r.mediaType&&"video"===r.mediaType?t.setAttributes({poster:e.poster,mediaUrl:e[n].transcodedMedia,src:e[n].transcodedMedia,rtBackgroundVideoQuality:n}):i&&t.setAttributes({poster:e.poster,src:e[n].transcodedMedia,rtBackgroundVideoQuality:n}))}))}var c=t.attributes.rtBackgroundVideoQuality;return c?t.setAttributes({className:"has-quality-".concat(c)}):t.setAttributes({rtBackgroundVideoQuality:b}),Object(n.createElement)(e,t)}}),11)}]);