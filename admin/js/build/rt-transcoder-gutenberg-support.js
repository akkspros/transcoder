!function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e){!function(){t.exports=this.wp.element}()},function(t,e){!function(){t.exports=this.wp.i18n}()},function(t,e){!function(){t.exports=this.wp.hooks}()},function(t,e){!function(){t.exports=this.wp.components}()},function(t,e){!function(){t.exports=this.wp.compose}()},function(t,e){!function(){t.exports=this.wp.blockEditor}()},function(t,e){!function(){t.exports=this.wp.apiFetch}()},function(t,e,r){"use strict";r.r(e);var o=r(0),n=r(4),i=r(3),a=r(2),c=r(1),d=r(5),u=r(6),s=r.n(u),l=["amp/amp-story-page","core/video"],p=window.rtTranscoderBlockEditorSupport,f=void 0!==p.rt_default_video_quality?p.rt_default_video_quality:"high";Object(a.addFilter)("blocks.registerBlockType","transcoder/ampStoryBackgroundVideoQuality",(function(t,e){return l.includes(e)?(void 0!==t.attributes&&(t.attributes=Object.assign(t.attributes,{rtBackgroundVideoInfo:{type:"object"},rtBackgroundVideoQuality:{type:"string",default:f}})),t):t}),9);var b=Object(n.createHigherOrderComponent)((function(t){return function(e){if(!l.includes(e.name))return Object(o.createElement)(t,e);var r=e.attributes,n="amp/amp-story-page"===e.name,a="core/video"===e.name,u=r.mediaType?r.mediaType:"",s=r.rtBackgroundVideoQuality;return Object(o.createElement)(o.Fragment,null,Object(o.createElement)(t,e),(a||n&&"video"===u)&&Object(o.createElement)(d.InspectorControls,null,Object(o.createElement)(i.PanelBody,{title:Object(c.__)("Transcoder Settings","transcoder"),initialOpen:!0},Object(o.createElement)(i.SelectControl,{label:Object(c.__)("Background Video Quality","transcoder"),value:s,options:[{value:"low",label:Object(c.__)("Low","transcoder")},{value:"medium",label:Object(c.__)("Medium","transcoder")},{value:"high",label:Object(c.__)("High","transcoder")}],onChange:function(t){e.setAttributes({rtBackgroundVideoQuality:t})}}))))}}),"withTranscoderSettings");Object(a.addFilter)("editor.BlockEdit","rt-transcoder-amp/with-transcoder-settings",b,12);Object(a.addFilter)("editor.BlockEdit","rt-transcoder-amp/set-media-attributes",(function(t){return function(e){if(!l.includes(e.name))return Object(o.createElement)(t,e);var r=e.attributes,n="amp/amp-story-page"===e.name,i="core/video"===e.name,a=n?r.mediaId:r.id;r.mediaType&&r.mediaType;if(void 0!==a)if(void 0===r.poster)n&&void 0!==r.mediaType&&"video"===r.mediaType&&!r.mediaUrl.endsWith("mp4")?e.setAttributes({poster:p.amp_story_fallback_poster}):i&&void 0!==r.src&&0!==r.src.indexOf("blob:")&&!r.src.endsWith("mp4")&&e.setAttributes({poster:p.amp_video_fallback_poster});else if(void 0!==e.attributes.rtBackgroundVideoInfo){var c=e.attributes.rtBackgroundVideoInfo,d=e.attributes.rtBackgroundVideoQuality?e.attributes.rtBackgroundVideoQuality:f;c.poster.length&&c[d].transcodedMedia.length&&(n&&void 0!==r.mediaType&&"video"===r.mediaType?e.setAttributes({poster:c.poster,mediaUrl:c[d].transcodedMedia,src:c[d].transcodedMedia,rtBackgroundVideoQuality:d}):i&&e.setAttributes({poster:c.poster,src:c[d].transcodedMedia,rtBackgroundVideoQuality:d}))}else{s()({path:"".concat("/transcoder/v1/amp-media","/").concat(a)}).then((function(t){!1!==t&&null!==t&&e.setAttributes({rtBackgroundVideoInfo:t})}))}var u=e.attributes.rtBackgroundVideoQuality;return u?e.setAttributes({className:"has-quality-".concat(u)}):e.setAttributes({rtBackgroundVideoQuality:f}),Object(o.createElement)(t,e)}}),11)}]);